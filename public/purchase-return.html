<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Purchase Return</title>
    <link rel="stylesheet" href="purchase-return.css">

</head>
<body>
    <div class="container">
	<div class="navbar">
		<a href="index.html" class="home-icon">
			<img src="home-icon.png" alt="Home" width="24">
		</a>
		<div class="dropdown">
			<button class="dropbtn">
				<img src="menu-icon.png" alt="Menu" width="24">
			</button>
			<div class="dropdown-content">
			<a href="container.html">Add Container</a>
			<a href="containers.html">Container List</a>
			<a href="buyers.html">Add Buyer</a>
			<a href="inventory.html">Inventory</a>
			<a href="purchase.html">Purchase History</a>
			<a href="received-payment.html">Received Payment</a>
			<a href="payment-history.html">Payment History</a>			
			<a href="sales-statement.html"> Sales Statement </a>
			<a href="purchase-return.html"class="active"> Purchase Return </a>
			<a href="return-history.html"> Return History </a>
			<a href="buyer-timeline.html"> Buyer Timeline </a>
			<a href="#" id="logout-btn"class="active2">Logout</a>
			</div>
		</div>
	</div>
	
	<div class="logo">
            <img src="logo.png" alt="Company Logo">
    </div>
        <h1>Purchase Return</h1>
        
        <form id="purchase-return-form">
            <!-- Select Date -->
            <div class="form-group">
                <label for="return-date">Return Date:</label>
                <input type="date" id="return-date" name="return-date" required>
            </div>
            
            <!-- Search and Select Buyer -->
            <div class="form-group">
                <label for="buyer-search">Search Buyer:</label>
                <input type="text" id="buyer-search" placeholder="Enter buyer name to search" oninput="filterBuyers()">
            </div>
            <div class="form-group">
                <label for="buyer-select">Select Buyer:</label>
                <select id="buyer-select" name="buyer-select" required>
                    <option value="0">Select Buyer</option> <!-- Default option -->
                    <!-- Buyer options will be populated dynamically -->
                </select>
            </div>
            
            <!-- Search and Select Container -->
            <div class="form-group">
                <label for="container-search">Search Container:</label>
                <input type="text" id="container-search" placeholder="Enter container number to search" oninput="filterContainers()">
            </div>
            <div class="form-group">
                <label for="container-select">Select Container:</label>
                <select id="container-select" name="container-select" required>
                    <option value="0">Select Container</option> <!-- Default option -->
                    <!-- Container options will be populated dynamically -->
                </select>
            </div>
			
			<p id="purchased-product-text"></p>
			
            <!-- Returned Product KG and Price per KG -->
            <div class="form-group">
                <label for="returned-kg">Returned Product (KG):</label>
                <input type="text" id="returned-kg" name="returned-kg" step="0.01" required>
            </div>
            <div class="form-group">
                <label for="returned-price-per-kg">Price per KG:</label>
                <input type="text" id="returned-price-per-kg" name="returned-price-per-kg" step="0.01" required>
            </div>

            <!-- Total Amount -->
            <div class="form-group">
                <label for="total-amount">Total Amount:</label>
                <input type="text" id="total-amount" name="total-amount" readonly>
            </div>

            <!-- Submit Button -->
            <div class="form-group">
                <button type="submit" id="submit-return" disabled>Submit</button> <!-- Initially disabled -->
            </div>
        </form>
    </div>

    <script src="purchase-return.js"></script>
	
		    <script>
        // Ensure the user is logged in
    // Ensure the user is logged in and has the appropriate role
    fetch('/check-role')
        .then(response => response.json())  // Parse JSON response from server
        .then(data => {
            if (!data.loggedIn) {
                window.location.href = '/login.html'; // Redirect to login page if not logged in
            } else {
                // Check if the logged-in user is an Admin
                if (data.role !== 'Admin') {
                    // If the user is not an Admin, redirect to index.html
                    window.location.href = '/index.html';
                }
            }
        })
        .catch(error => {
            console.error('Error checking user role:', error);
            window.location.href = '/login.html'; // Redirect to login if error occurs
        });

    </script>
</body>
</html>
