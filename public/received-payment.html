<!DOCTYPE html>
<html>
<head>
    <title>Received Payment</title>
    <link rel="stylesheet" href="received-payment.css">
</head>
<body>

    <form id="payment-form">
        <div class="navbar">
            <a href="index.html" class="home-icon">
                <img src="home-icon.png" alt="Home" width="32">
            </a>
            <div class="dropdown">
                <button class="dropbtn">
                    <img src="menu-icon.png" alt="Menu">
                </button>
                <div class="dropdown-content">
                    <a href="container.html">Add Container</a>
                    <a href="containers.html">Container List</a>
                    <a href="buyers.html">Add Buyer</a>
                    <a href="inventory.html">Inventory</a>
                    <a href="purchase.html">Sales History</a>
                    <a href="received-payment.html" class="active">Received Payment</a>
                    <a href="payment-history.html">Payment History</a>
                    <a href="sales-statement.html">Sales Statement</a>
                    <a href="purchase-return.html">Sales Return</a>
					<a href="previous-sales-return.html">Previous Sales Return</a>
                    <a href="return-history.html">Return History</a>
					<a href="buyer-timeline.html">Buyer Timeline</a>
					<a href="#" id="logout-btn"class="active2">Logout</a>
                </div>
            </div>
        </div>

        <div class="logo">
            <img src="logo.png" alt="Company Logo">
        </div>

        <h1>Received Payment</h1>

        <!-- Select Buyer -->
        <label>Select Buyer:</label>
        <select id="buyer-dropdown" required>
            <option value="">Select a Buyer</option>
        </select><br><br>

        <!-- Display Unpaid Balance -->
        <label>Unpaid Balance (BDT):</label>
        <span id="unpaid-amount">0</span><br><br> <!-- ðŸ”¹ Shows unpaid amount -->

        <!-- Payment Date -->
        <label>Payment Date:</label>
        <input type="date" id="payment-date" required><br><br>

        <!-- Payment Method -->
        <label>Payment Method:</label>
        <select id="payment-method" required>
            <option value="cash">Cash</option>
            <option value="bank">Bank</option>
        </select><br><br>

        <!-- Particulars (for Bank Payment only) -->
        <label>Particulars:</label>
        <input type="text" id="particulars" placeholder="Enter bank particulars" disabled autocomplete="off"><br><br>

        <!-- Payment Amount -->
        <label>Payment Amount:</label>
        <input type="text" id="payment-amount" step="0.01" data-max-amount="0" autocomplete="off" required><br><br>

        <!-- Submit Button -->
        <button type="submit" class="submit-payment">Submit Payment</button>
    </form>

    <div id="success-popup" style="display: none;">
        Payment Received Successfully!
    </div>

    <script src="received-payment.js"></script>
	
	<script>
        // Ensure the user is logged in
    // Ensure the user is logged in and has the appropriate role
    fetch('/check-role')
        .then(response => response.json())  // Parse JSON response from server
        .then(data => {
            if (!data.loggedIn) {
                window.location.href = '/login.html'; // Redirect to login page if not logged in
            } else {
                // Check if the logged-in user is an Admin
                if (data.role !== 'Admin') {
                    // If the user is not an Admin, redirect to index.html
                    window.location.href = '/index.html';
                }
            }
        })
        .catch(error => {
            console.error('Error checking user role:', error);
            window.location.href = '/login.html'; // Redirect to login if error occurs
        });

    </script>
	
</body>
</html>
